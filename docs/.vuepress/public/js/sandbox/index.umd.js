!function(g,I){"object"==typeof exports&&"undefined"!=typeof module?I(exports,require("@wu-component/web-core-plus")):"function"==typeof define&&define.amd?define(["exports","@wu-component/web-core-plus"],I):I((g="undefined"!=typeof globalThis?globalThis:g||self).WuCodeSandbox={},g.webCorePlus)}(this,(function(g,I){"use strict";var C=function(g,I){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,I){g.__proto__=I}||function(g,I){for(var C in I)Object.prototype.hasOwnProperty.call(I,C)&&(g[C]=I[C])},C(g,I)};var A=function(){return A=Object.assign||function(g){for(var I,C=1,A=arguments.length;C<A;C++)for(var e in I=arguments[C])Object.prototype.hasOwnProperty.call(I,e)&&(g[e]=I[e]);return g},A.apply(this,arguments)};function e(g,I,C,A){var e,n=arguments.length,o=n<3?I:null===A?A=Object.getOwnPropertyDescriptor(I,C):A;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(g,I,C,A);else for(var t=g.length-1;t>=0;t--)(e=g[t])&&(o=(n<3?e(o):n>3?e(I,C,o):e(I,C))||o);return n>3&&o&&Object.defineProperty(I,C,o),o}function n(g,I){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(g,I)}function o(g,I,C,A){return new(C||(C=Promise))((function(e,n){function o(g){try{c(A.next(g))}catch(g){n(g)}}function t(g){try{c(A.throw(g))}catch(g){n(g)}}function c(g){var I;g.done?e(g.value):(I=g.value,I instanceof C?I:new C((function(g){g(I)}))).then(o,t)}c((A=A.apply(g,I||[])).next())}))}function t(g,I){var C,A,e,n,o={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return n={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function t(n){return function(t){return function(n){if(C)throw new TypeError("Generator is already executing.");for(;o;)try{if(C=1,A&&(e=2&n[0]?A.return:n[0]?A.throw||((e=A.return)&&e.call(A),0):A.next)&&!(e=e.call(A,n[1])).done)return e;switch(A=0,e&&(n=[2&n[0],e.value]),n[0]){case 0:case 1:e=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,A=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!(e=o.trys,(e=e.length>0&&e[e.length-1])||6!==n[0]&&2!==n[0])){o=0;continue}if(3===n[0]&&(!e||n[1]>e[0]&&n[1]<e[3])){o.label=n[1];break}if(6===n[0]&&o.label<e[1]){o.label=e[1],e=n;break}if(e&&o.label<e[2]){o.label=e[2],o.ops.push(n);break}e[2]&&o.ops.pop(),o.trys.pop();continue}n=I.call(g,o)}catch(g){n=[6,g],A=0}finally{C=e=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,t])}}}var c=":host {\n  width: 100%;\n  height: 100%;\n}\n\n.containerViewer {\n  width: 100%;\n  height: 100%;\n}\n\n#codeIframe {\n  width: 100%;\n  height: 100%;\n}";!function(g,I){void 0===I&&(I={});var C=I.insertAt;if(g&&"undefined"!=typeof document){var A=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css","top"===C&&A.firstChild?A.insertBefore(e,A.firstChild):A.appendChild(e),e.styleSheet?e.styleSheet.cssText=g:e.appendChild(document.createTextNode(g))}}(c);var i=1,l=function(){function g(g,I){var C=this;this.iframe=g,this.handlers=I,this.pending_cmds=new Map,this.handle_event=function(g){return C.handle_repl_message(g)},window.addEventListener("message",this.handle_event,!1)}return g.prototype.destroy=function(){window.removeEventListener("message",this.handle_event)},g.prototype.iframe_command=function(g,I){var C=this;return new Promise((function(A,e){var n=i++;C.pending_cmds.set(n,{resolve:A,reject:e}),C.iframe.contentWindow.postMessage({action:g,cmd_id:n,args:I},"*")}))},g.prototype.handle_command_message=function(g){var I=g.action,C=g.cmd_id,A=this.pending_cmds.get(C);if(A){if(this.pending_cmds.delete(C),"cmd_error"===I){var e=g.message,n=g.stack,o=new Error(e);o.stack=n,A.reject(o)}"cmd_ok"===I&&A.resolve(g.args)}else"cmd_error"!==I&&"cmd_ok"!==I&&console.error("command not found",C,g,function(g,I,C){if(C||2===arguments.length)for(var A,e=0,n=I.length;e<n;e++)!A&&e in I||(A||(A=Array.prototype.slice.call(I,0,e)),A[e]=I[e]);return g.concat(A||Array.prototype.slice.call(I))}([],function(g,I){var C="function"==typeof Symbol&&g[Symbol.iterator];if(!C)return g;var A,e,n=C.call(g),o=[];try{for(;(void 0===I||I-- >0)&&!(A=n.next()).done;)o.push(A.value)}catch(g){e={error:g}}finally{try{A&&!A.done&&(C=n.return)&&C.call(n)}finally{if(e)throw e.error}}return o}(this.pending_cmds.keys()),!1))},g.prototype.handle_repl_message=function(g){if(g.source===this.iframe.contentWindow){var I=g.data,C=I.action,A=I.args;switch(this.handlers.on_default_event(g),C){case"cmd_error":case"cmd_ok":return this.handle_command_message(g.data);case"fetch_progress":return this.handlers.on_fetch_progress(A.remaining);case"error":return this.handlers.on_error(g.data);case"unhandledrejection":return this.handlers.on_unhandled_rejection(g.data);case"console":return this.handlers.on_console(g.data);case"console_group":return this.handlers.on_console_group(g.data);case"console_group_collapsed":return this.handlers.on_console_group_collapsed(g.data);case"console_group_end":return this.handlers.on_console_group_end(g.data)}}},g.prototype.eval=function(g){return this.iframe_command("eval",{script:g})},g.prototype.handle_links=function(){return this.iframe_command("catch_clicks",{})},g.prototype.load_depend=function(g){return this.iframe_command("load_dependencies",g)},g}(),d="CODE_DEPENDENCIES",s="CODE_TYPES",b=function(){function g(g){void 0===g&&(g={dependencies:{},types:{}}),this.code=[],this.init(g)}return g.prototype.init=function(g){var I=g.dependencies,C=void 0===I?{}:I,e=g.types,n=void 0===e?{}:e,o=localStorage.getItem(d)?JSON.parse(localStorage.getItem(d)):{},t=localStorage.getItem(s)?JSON.parse(localStorage.getItem(s)):{};o=A(A({},o),C||{}),t=A(A({},t),{types:n||{}}),localStorage.setItem(d,JSON.stringify(o)),localStorage.setItem(s,JSON.stringify(t)),this.__dependencies=o,this.__types=t},g.prototype.createDependencies=function(g,I){this.__dependencies=A(A({},this.__dependencies),{name:I}),localStorage.setItem(d,JSON.stringify(this.__dependencies))},Object.defineProperty(g.prototype,"dependencies",{get:function(){return this.__dependencies},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"types",{get:function(){return this.__types},enumerable:!1,configurable:!0}),g.prototype.pushStackCode=function(g){this.code.push(g)},g}(),r=function(g){function A(){var I=g.call(this)||this;return I.container=null,I.isLoad=!1,I}return function(g,I){if("function"!=typeof I&&null!==I)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function A(){this.constructor=g}C(g,I),g.prototype=null===I?Object.create(I):(A.prototype=I.prototype,new A)}(A,g),A.prototype.formatFile=function(g){return new Promise((function(I){if(g.startsWith("data:")){for(var C=g.split(","),A=atob(C[1]),e=A.length,n=new Uint8Array(e);e--;)n[e]=A.charCodeAt(e);var o=new File([n],"srcdoc.html",{type:"text/html"}),t=new FileReader;t.onload=function(){I(t.result)},t.readAsText(o,"utf-8")}else I(g)}))},A.prototype.connected=function(g){return o(this,void 0,void 0,(function(){var g,I,C,A,e,n=this;return t(this,(function(o){switch(o.label){case 0:return g=this.props.initialSrcDoc,I=document.createElement("div"),C={},g?(A=this,[4,this.formatFile(g)]):[3,2];case 1:A.initialSrcDoc=o.sent(),I.innerHTML=this.initialSrcDoc,e=I.querySelector("#dependenciesMap"),C=JSON.parse(e.innerHTML)?JSON.parse(e.innerHTML).imports:{},o.label=2;case 2:return this.previewStore=new b({dependencies:C}),this.proxy=new l(this.container,{on_fetch_progress:function(g){},on_error:function(g){console.log("on_error",g)},on_unhandled_rejection:function(g){console.log("on_unhandled_rejection",g)},on_console:function(g){console.log("log",g)},on_console_group:function(g){},on_console_group_end:function(g){},on_console_group_collapsed:function(g){},on_default_event:function(g){n.emitEvent(g)}}),this.container.addEventListener("load",(function(){n.proxy.handle_links().then((function(g){})),n.proxy.load_depend({dependencies:n.previewStore.dependencies}).then((function(){for(var g=0;g<n.previewStore.code.length;g++)n.proxy.eval(n.previewStore.code[g]);n.previewStore.code=[]})),!1===n.isLoad&&(n.isLoad=!0,n.emitSuccessEvent())})),this.container.setAttribute("srcdoc",this.initialSrcDoc),[2]}}))}))},A.prototype.runCode=function(g,I){this.props.isBeforeRefresh?(this.container.contentWindow.location.reload(),this.previewStore.pushStackCode(I)):this.proxy.eval(I)},A.prototype.loadDependencies=function(g){return this.proxy.load_depend(g)},A.prototype.emitEvent=function(g){return g||{}},A.prototype.emitSuccessEvent=function(){return!0},A.prototype.render=function(g,C){var A=this;return I.h("div",{class:"containerViewer"},I.h("iframe",{frameBorder:"0",ref:function(g){return A.container=g},id:"codeIframe",sandbox:["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts","allow-top-navigation-by-user-activation"].join(" ")}))},e([I.Prop({type:String,default:"data:text/html;base64,PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+DQogICAgPHN0eWxlPg0KICAgICAgICBib2R5LCBodG1sICB7DQogICAgICAgICAgICBtYXJnaW46IDA7DQogICAgICAgIH0NCiAgICA8L3N0eWxlPg0KICAgIDx0aXRsZT5UaXRsZTwvdGl0bGU+DQogICAgPHNjcmlwdCBhc3luYyBzcmM9Imh0dHBzOi8vdW5wa2cuY29tL2VzLW1vZHVsZS1zaGltc0AxLjUuMTgvZGlzdC9lcy1tb2R1bGUtc2hpbXMud2FzbS5qcyI+PC9zY3JpcHQ+DQogICAgPCEtLSBmb3IgdHlwZXNjcmlwdCB0YXJnZXQ6IEFNRCAtLT4NCiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3JlcXVpcmVqcy9yZXF1aXJlanMvcmVxdWlyZS5qcyI+PC9zY3JpcHQ+DQogICAgPCEtLTxzY3JpcHQgc3JjPSJodHRwczovL3VucGtnLmNvbS9Ad3UtY29tcG9uZW50L3dlYi1jb3JlLXBsdXNAMC4zLjMvZGlzdC9pbmRleC5lcy5qcyI+PC9zY3JpcHQ+LS0+DQogICAgPHNjcmlwdCB0eXBlPSJpbXBvcnRtYXAiIGlkPSJkZXBlbmRlbmNpZXNNYXAiPg0KICAgICAgICB7DQogICAgICAgICAgImltcG9ydHMiOiB7fQ0KICAgICAgICB9DQogICAgPC9zY3JpcHQ+DQogICAgPHNjcmlwdD4NCiAgICAgICAgKCgpID0+IHsNCiAgICAgICAgICAgIGxldCBzY3JpcHRFbHMgPSBbXQ0KDQogICAgICAgICAgICB3aW5kb3cucHJvY2VzcyA9IHsgZW52OiB7fSB9DQogICAgICAgICAgICB3aW5kb3cuX19tb2R1bGVzX18gPSB7fQ0KDQogICAgICAgICAgICB3aW5kb3cuX19leHBvcnRfXyA9IChtb2QsIGtleSwgZ2V0KSA9PiB7DQogICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZCwga2V5LCB7DQogICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsDQogICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwNCiAgICAgICAgICAgICAgICAgICAgZ2V0DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93Ll9fZHluYW1pY19pbXBvcnRfXyA9IGtleSA9PiB7DQogICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh3aW5kb3cuX19tb2R1bGVzX19ba2V5XSkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiDliqDovb3kvp3otZYNCiAgICAgICAgICAgICAqIEBwYXJhbSBvcHRpb25zDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIGZ1bmN0aW9uIGxvYWRfZGVwZW5kZW5jaWVzKG9wdGlvbnMpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBkb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjZGVwZW5kZW5jaWVzTWFwIik7DQogICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IEpTT04ucGFyc2UoZG9tLmlubmVySFRNTCk/IEpTT04ucGFyc2UoZG9tLmlubmVySFRNTCkuaW1wb3J0czoge30NCiAgICAgICAgICAgICAgICBjb25zdCBuZXdEZXBlbmRlbmNpZXMgPSBPYmplY3QuYXNzaWduKHt9LCBjdXJyZW50LCBvcHRpb25zLmRlcGVuZGVuY2llcyB8fCB7fSk7DQogICAgICAgICAgICAgICAgZG9tLmlubmVySFRNTCA9IEpTT04uc3RyaW5naWZ5KHsNCiAgICAgICAgICAgICAgICAgICAgImltcG9ydHMiOiBuZXdEZXBlbmRlbmNpZXMNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIGNvbnN0IG5ld0RvbSA9IGRvbS5jbG9uZU5vZGUodHJ1ZSk7DQogICAgICAgICAgICAgICAgZG9tLnJlbW92ZSgpDQogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiaGVhZCIpLmFwcGVuZENoaWxkKG5ld0RvbSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZV9tZXNzYWdlKGV2KSB7DQogICAgICAgICAgICAgICAgbGV0IHsgYWN0aW9uLCBjbWRfaWQgfSA9IGV2LmRhdGE7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VuZF9tZXNzYWdlID0gKHBheWxvYWQpID0+IHBhcmVudC5wb3N0TWVzc2FnZSggeyAuLi5wYXlsb2FkIH0sIGV2Lm9yaWdpbik7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VuZF9yZXBseSA9IChwYXlsb2FkKSA9PiBzZW5kX21lc3NhZ2UoeyAuLi5wYXlsb2FkLCBjbWRfaWQgfSk7DQogICAgICAgICAgICAgICAgY29uc3Qgc2VuZF9vayA9ICgpID0+IHNlbmRfcmVwbHkoeyBhY3Rpb246ICdjbWRfb2snIH0pOw0KICAgICAgICAgICAgICAgIGNvbnN0IHNlbmRfZXJyb3IgPSAobWVzc2FnZSwgc3RhY2spID0+IHNlbmRfcmVwbHkoeyBhY3Rpb246ICdjbWRfZXJyb3InLCBtZXNzYWdlLCBzdGFjayB9KTsNCg0KICAgICAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdldmFsJykgew0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjcmlwdEVscy5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRFbHMuZm9yRWFjaChlbCA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmhlYWQucmVtb3ZlQ2hpbGQoZWwpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRFbHMubGVuZ3RoID0gMA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgeyBzY3JpcHQ6IHNjcmlwdHMgfSA9IGV2LmRhdGEuYXJncw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzY3JpcHRzID09PSAnc3RyaW5nJykgc2NyaXB0cyA9IFtzY3JpcHRzXQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHNjcmlwdCBvZiBzY3JpcHRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2NyaXB0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdEVsLnNldEF0dHJpYnV0ZSgndHlwZScsICdtb2R1bGUnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbmQgb2sgaW4gdGhlIG1vZHVsZSBzY3JpcHQgdG8gZW5zdXJlIHNlcXVlbnRpYWwgZXZhbHVhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIG11bHRpcGxlIHByb3h5LmV2YWwoKSBjYWxscw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbmUgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuX19uZXh0X18gPSByZXNvbHZlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JpcHRFbC5pbm5lckhUTUwgPSBzY3JpcHQgKyBgXG53aW5kb3cuX19uZXh0X18oKWANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdEVsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdEVsLm9uZXJyb3IgPSBlcnIgPT4gc2VuZF9lcnJvcihlcnIubWVzc2FnZSwgZXJyLnN0YWNrKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcmlwdEVscy5wdXNoKHNjcmlwdEVsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGRvbmUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRfb2soKQ0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kX2Vycm9yKGUubWVzc2FnZSwgZS5zdGFjayk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnY2F0Y2hfY2xpY2tzJykgew0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9wX29yaWdpbiA9IGV2Lm9yaWdpbjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudCA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoICE9PSAxKSByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm1ldGFLZXkgfHwgZXZlbnQuY3RybEtleSB8fCBldmVudC5zaGlmdEtleSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5kZWZhdWx0UHJldmVudGVkKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbnN1cmUgdGFyZ2V0IGlzIGEgbGluaw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbCA9IGV2ZW50LnRhcmdldDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZWwgJiYgZWwubm9kZU5hbWUgIT09ICdBJykgZWwgPSBlbC5wYXJlbnROb2RlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZWwgfHwgZWwubm9kZU5hbWUgIT09ICdBJykgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnZG93bmxvYWQnKSB8fCBlbC5nZXRBdHRyaWJ1dGUoJ3JlbCcpID09PSAnZXh0ZXJuYWwnIHx8IGVsLnRhcmdldCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbC5ocmVmLnN0YXJ0c1dpdGgodG9wX29yaWdpbikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChlbC5ocmVmKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVybC5oYXNoWzBdID09PSAnIycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gdXJsLmhhc2g7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3BlbihlbC5ocmVmLCAnX2JsYW5rJyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRfb2soKTsNCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kX2Vycm9yKGUubWVzc2FnZSwgZS5zdGFjayk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSAibG9hZF9kZXBlbmRlbmNpZXMiKSB7DQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsb2FkX2RlcGVuZGVuY2llcyhldi5kYXRhLmFyZ3MpOw0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZF9vaygpDQogICAgICAgICAgICAgICAgICAgIH1jYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZF9lcnJvcihlLm1lc3NhZ2UsIGUuc3RhY2spOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaGFuZGxlX21lc3NhZ2UsIGZhbHNlKTsNCg0KICAgICAgICAgICAgd2luZG93Lm9uZXJyb3IgPSBmdW5jdGlvbiAobXNnLCB1cmwsIGxpbmVObywgY29sdW1uTm8sIGVycm9yKSB7DQogICAgICAgICAgICAgICAgaWYgKG1zZy5pbmNsdWRlcygnbW9kdWxlIHNwZWNpZmllciDigJx2dWXigJ0nKSkgew0KICAgICAgICAgICAgICAgICAgICAvLyBmaXJlZm94IG9ubHkgZXJyb3IsIGlnbm9yZQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHsgYWN0aW9uOiAnZXJyb3InLCB2YWx1ZTogZXJyb3IgfSwgJyonKTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ2Vycm9yJywgdmFsdWU6IG1zZyB9LCAnKicpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInVuaGFuZGxlZHJlamVjdGlvbiIsIGV2ZW50ID0+IHsNCiAgICAgICAgICAgICAgICBpZiAoZXZlbnQucmVhc29uLm1lc3NhZ2UuaW5jbHVkZXMoJ0Nyb3NzLW9yaWdpbicpKSB7DQogICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCkNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ3VuaGFuZGxlZHJlamVjdGlvbicsIHZhbHVlOiBldmVudC5yZWFzb24gfSwgJyonKTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ3VuaGFuZGxlZHJlamVjdGlvbicsIHZhbHVlOiBldmVudC5yZWFzb24ubWVzc2FnZSB9LCAnKicpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBsZXQgcHJldmlvdXMgPSB7IGxldmVsOiBudWxsLCBhcmdzOiBudWxsIH07DQoNCiAgICAgICAgICAgIFsnY2xlYXInLCAnbG9nJywgJ2luZm8nLCAnZGlyJywgJ3dhcm4nLCAnZXJyb3InLCAndGFibGUnXS5mb3JFYWNoKChsZXZlbCkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsID0gY29uc29sZVtsZXZlbF07DQogICAgICAgICAgICAgICAgY29uc29sZVtsZXZlbF0gPSAoLi4uYXJncykgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBtc2cgPSBTdHJpbmcoYXJnc1swXSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKA0KICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmluY2x1ZGVzKCdZb3UgYXJlIHJ1bm5pbmcgYSBkZXZlbG9wbWVudCBidWlsZCBvZiBWdWUnKSB8fA0KICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmluY2x1ZGVzKCdZb3UgYXJlIHJ1bm5pbmcgdGhlIGVzbS1idW5kbGVyIGJ1aWxkIG9mIFZ1ZScpDQogICAgICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RyaW5naWZpZWRBcmdzID0gc3RyaW5naWZ5KGFyZ3MpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91cy5sZXZlbCA9PT0gbGV2ZWwgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzLmFyZ3MgJiYNCiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzLmFyZ3MgPT09IHN0cmluZ2lmaWVkQXJncw0KICAgICAgICAgICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ2NvbnNvbGUnLCBsZXZlbCwgZHVwbGljYXRlOiB0cnVlIH0sICcqJyk7DQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91cyA9IHsgbGV2ZWwsIGFyZ3M6IHN0cmluZ2lmaWVkQXJncyB9Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ2NvbnNvbGUnLCBsZXZlbCwgYXJncyB9LCAnKicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHsgYWN0aW9uOiAnY29uc29sZScsIGxldmVsLCBhcmdzOiBhcmdzLm1hcChhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhIGluc3RhbmNlb2YgRXJyb3IgPyBhLm1lc3NhZ2UgOiBTdHJpbmcoYSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgfSwgJyonKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsKC4uLmFyZ3MpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBbDQogICAgICAgICAgICAgICAgeyBtZXRob2Q6ICdncm91cCcsIGFjdGlvbjogJ2NvbnNvbGVfZ3JvdXAnIH0sDQogICAgICAgICAgICAgICAgeyBtZXRob2Q6ICdncm91cEVuZCcsIGFjdGlvbjogJ2NvbnNvbGVfZ3JvdXBfZW5kJyB9LA0KICAgICAgICAgICAgICAgIHsgbWV0aG9kOiAnZ3JvdXBDb2xsYXBzZWQnLCBhY3Rpb246ICdjb25zb2xlX2dyb3VwX2NvbGxhcHNlZCcgfSwNCiAgICAgICAgICAgIF0uZm9yRWFjaCgoZ3JvdXBfYWN0aW9uKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWwgPSBjb25zb2xlW2dyb3VwX2FjdGlvbi5tZXRob2RdOw0KICAgICAgICAgICAgICAgIGNvbnNvbGVbZ3JvdXBfYWN0aW9uLm1ldGhvZF0gPSAobGFiZWwpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHsgYWN0aW9uOiBncm91cF9hY3Rpb24uYWN0aW9uLCBsYWJlbCB9LCAnKicpOw0KDQogICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsKGxhYmVsKTsNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIGNvbnN0IHRpbWVycyA9IG5ldyBNYXAoKTsNCiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsX3RpbWUgPSBjb25zb2xlLnRpbWU7DQogICAgICAgICAgICBjb25zdCBvcmlnaW5hbF90aW1lbG9nID0gY29uc29sZS50aW1lTG9nOw0KICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxfdGltZWVuZCA9IGNvbnNvbGUudGltZUVuZDsNCg0KICAgICAgICAgICAgY29uc29sZS50aW1lID0gKGxhYmVsID0gJ2RlZmF1bHQnKSA9PiB7DQogICAgICAgICAgICAgICAgb3JpZ2luYWxfdGltZShsYWJlbCk7DQogICAgICAgICAgICAgICAgdGltZXJzLnNldChsYWJlbCwgcGVyZm9ybWFuY2Uubm93KCkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY29uc29sZS50aW1lTG9nID0gKGxhYmVsID0gJ2RlZmF1bHQnKSA9PiB7DQogICAgICAgICAgICAgICAgb3JpZ2luYWxfdGltZWxvZyhsYWJlbCk7DQogICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gcGVyZm9ybWFuY2Uubm93KCk7DQogICAgICAgICAgICAgICAgaWYgKHRpbWVycy5oYXMobGFiZWwpKSB7DQogICAgICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ2NvbnNvbGUnLCBsZXZlbDogJ3N5c3RlbS1sb2cnLCBhcmdzOiBbYCR7bGFiZWx9OiAke25vdyAtIHRpbWVycy5nZXQobGFiZWwpfW1zYF0gfSwgJyonKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBhY3Rpb246ICdjb25zb2xlJywgbGV2ZWw6ICdzeXN0ZW0td2FybicsIGFyZ3M6IFtgVGltZXIgJyR7bGFiZWx9JyBkb2VzIG5vdCBleGlzdGBdIH0sICcqJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY29uc29sZS50aW1lRW5kID0gKGxhYmVsID0gJ2RlZmF1bHQnKSA9PiB7DQogICAgICAgICAgICAgICAgb3JpZ2luYWxfdGltZWVuZChsYWJlbCk7DQogICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gcGVyZm9ybWFuY2Uubm93KCk7DQogICAgICAgICAgICAgICAgaWYgKHRpbWVycy5oYXMobGFiZWwpKSB7DQogICAgICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ2NvbnNvbGUnLCBsZXZlbDogJ3N5c3RlbS1sb2cnLCBhcmdzOiBbYCR7bGFiZWx9OiAke25vdyAtIHRpbWVycy5nZXQobGFiZWwpfW1zYF0gfSwgJyonKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBhY3Rpb246ICdjb25zb2xlJywgbGV2ZWw6ICdzeXN0ZW0td2FybicsIGFyZ3M6IFtgVGltZXIgJyR7bGFiZWx9JyBkb2VzIG5vdCBleGlzdGBdIH0sICcqJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRpbWVycy5kZWxldGUobGFiZWwpOw0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxfYXNzZXJ0ID0gY29uc29sZS5hc3NlcnQ7DQogICAgICAgICAgICBjb25zb2xlLmFzc2VydCA9IChjb25kaXRpb24sIC4uLmFyZ3MpID0+IHsNCiAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YWNrID0gbmV3IEVycm9yKCkuc3RhY2s7DQogICAgICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ2NvbnNvbGUnLCBsZXZlbDogJ2Fzc2VydCcsIGFyZ3MsIHN0YWNrIH0sICcqJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIG9yaWdpbmFsX2Fzc2VydChjb25kaXRpb24sIC4uLmFyZ3MpOw0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgY29uc3QgY291bnRlciA9IG5ldyBNYXAoKTsNCiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsX2NvdW50ID0gY29uc29sZS5jb3VudDsNCiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsX2NvdW50cmVzZXQgPSBjb25zb2xlLmNvdW50UmVzZXQ7DQoNCiAgICAgICAgICAgIGNvbnNvbGUuY291bnQgPSAobGFiZWwgPSAnZGVmYXVsdCcpID0+IHsNCiAgICAgICAgICAgICAgICBjb3VudGVyLnNldChsYWJlbCwgKGNvdW50ZXIuZ2V0KGxhYmVsKSB8fCAwKSArIDEpOw0KICAgICAgICAgICAgICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7IGFjdGlvbjogJ2NvbnNvbGUnLCBsZXZlbDogJ3N5c3RlbS1sb2cnLCBhcmdzOiBgJHtsYWJlbH06ICR7Y291bnRlci5nZXQobGFiZWwpfWAgfSwgJyonKTsNCiAgICAgICAgICAgICAgICBvcmlnaW5hbF9jb3VudChsYWJlbCk7DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICBjb25zb2xlLmNvdW50UmVzZXQgPSAobGFiZWwgPSAnZGVmYXVsdCcpID0+IHsNCiAgICAgICAgICAgICAgICBpZiAoY291bnRlci5oYXMobGFiZWwpKSB7DQogICAgICAgICAgICAgICAgICAgIGNvdW50ZXIuc2V0KGxhYmVsLCAwKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBwYXJlbnQucG9zdE1lc3NhZ2UoeyBhY3Rpb246ICdjb25zb2xlJywgbGV2ZWw6ICdzeXN0ZW0td2FybicsIGFyZ3M6IGBDb3VudCBmb3IgJyR7bGFiZWx9JyBkb2VzIG5vdCBleGlzdGAgfSwgJyonKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgb3JpZ2luYWxfY291bnRyZXNldChsYWJlbCk7DQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICBjb25zdCBvcmlnaW5hbF90cmFjZSA9IGNvbnNvbGUudHJhY2U7DQoNCiAgICAgICAgICAgIGNvbnNvbGUudHJhY2UgPSAoLi4uYXJncykgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YWNrID0gbmV3IEVycm9yKCkuc3RhY2s7DQogICAgICAgICAgICAgICAgcGFyZW50LnBvc3RNZXNzYWdlKHsgYWN0aW9uOiAnY29uc29sZScsIGxldmVsOiAndHJhY2UnLCBhcmdzLCBzdGFjayB9LCAnKicpOw0KICAgICAgICAgICAgICAgIG9yaWdpbmFsX3RyYWNlKC4uLmFyZ3MpOw0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgZnVuY3Rpb24gc3RyaW5naWZ5KGFyZ3MpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJncyk7DQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KSgpDQogICAgPC9zY3JpcHQ+DQo8L2hlYWQ+DQo8Ym9keT4NCiAgICA8ZGl2IGlkPSJhcHAiPjwvZGl2Pg0KPC9ib2R5Pg0KPC9odG1sPg0K"}),n("design:type",String)],A.prototype,"initialSrcDoc",void 0),e([I.Prop({type:Boolean,default:!1}),n("design:type",Boolean)],A.prototype,"isBeforeRefresh",void 0),e([I.Emit("message"),n("design:type",Function),n("design:paramtypes",[Object]),n("design:returntype",void 0)],A.prototype,"emitEvent",null),e([I.Emit("success"),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],A.prototype,"emitSuccessEvent",null),A=e([I.Component({name:"wu-code-sandbox",css:c}),n("design:paramtypes",[])],A)}(I.WuComponent);g.WuMonacoEditorPreview=r,Object.defineProperty(g,"__esModule",{value:!0})}));
